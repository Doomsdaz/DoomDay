<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Ball</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            overflow: hidden;
            font-family: Arial, sans-serif;
            background: black;
            color: white;
        }

        canvas {
            display: block;
            margin: 0 auto;
        }

        .header {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            z-index: 10;
        }

        .header h1 {
            font-size: 2rem;
            color: white;
            text-shadow: 0 0 35px #ff5722, 0 0 30px #ff5722;
        }

        .jump-btn,
        .restart-btn {
            position: fixed;
            width: 140px;
            height: 60px;
            background-color: black;
            color: white;
            font-size: 1.2rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            z-index: 100;
            text-align: center;
            line-height: 50px;
        }

        .jump-btn {
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0px 0px 20px red;
        }

        .restart-btn {
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: none;
            box-shadow: 0px 0px 20px red;
        }

        .score {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2rem;
            color: white;
        }

        .rank {
            position: absolute;
            top: 70px;
            right: 20px;
            font-size: 1.5rem;
            color: white;
        }

        .rank span {
            color: #ff5722;
        }

        .highest-rank {
            position: absolute;
            top: 120px;
            right: 20px;
            font-size: 1.5rem;
            color: white;
        }

        .highest-rank span {
            color: #00ff00;
        }
    </style>
</head>

<body>
    <div class="header">
        <h1 id="flappyTitle">Flappy Ball</h1>
    </div>
    <canvas id="gameCanvas"></canvas>
    <button class="jump-btn" id="jumpBtn">JUMP</button>
    <button class="restart-btn" id="restartBtn">RESTART</button>
    <div class="score" id="score">Score: 0</div>
    <div class="rank" id="rank">Rank: <span>None</span></div>
    <div class="highest-rank" id="highestRank">Highest Rank: <span>None</span></div>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const bird = {
            x: canvas.width / 4,
            y: canvas.height / 2,
            size: 10,
            gravity: 0.4,
            lift: -6,
            velocity: 0
        };

        let pipes = [];
        const pipeWidth = 10;
        const pipeGap = 250;
        const pipeDistance = 350; // Fixed distance between poles
        let pipeSpeed = 2;
        let frame = 0;
        let score = 0;
        let gameRunning = true;
        let hasSpeedIncreased = false;

        const scoreDisplay = document.getElementById("score");
        const rankDisplay = document.getElementById("rank");
        const highestRankDisplay = document.getElementById("highestRank");

        let highestRank = "None";
        const ranks = [
            "Bot",
            "Bronze III",
            "Bronze II",
            "Bronze I",
            "Silver III",
            "Silver II",
            "Silver I",
            "Iron III",
            "Iron II",
            "Iron I",
            "Gold III",
            "Gold II",
            "Gold I",
            "Platinum III",
            "Platinum II",
            "Platinum I",
            "Diamond III",
            "Diamond II",
            "Diamond I",
            "Heroic",
            "★★★ Grandmaster III",
            "★★ Grandmaster II",
            "★ Grandmaster I"
        ];

        let particles = []; 

        function updateRankAndSpeed() {
            let rankIndex = Math.min(Math.floor(score / 5), ranks.length - 1);
            const currentRank = ranks[rankIndex];
            rankDisplay.innerHTML = `Rank: <span>${currentRank}</span>`;

            if (ranks.indexOf(currentRank) > ranks.indexOf(highestRank)) {
                highestRank = currentRank;
                highestRankDisplay.innerHTML = `Highest Rank: <span>${highestRank}</span>`;
            }

            if (score > 0 && !hasSpeedIncreased) {
                pipeSpeed += 1;
                hasSpeedIncreased = true;
            }
        }

        function updateScore() {
            score += 1;
            scoreDisplay.textContent = `Score: ${score}`;
            updateRankAndSpeed();
        }

        function drawBird() {
            ctx.fillStyle = "white";
            ctx.beginPath();
            ctx.arc(bird.x, bird.y, bird.size, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawParticles() {
            particles.forEach((particle, index) => {
                ctx.fillStyle = `rgba(255, 255, 255, ${particle.opacity})`;
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                ctx.fill();

                particle.x -= particle.speed;
                particle.opacity -= 0.02;

                if (particle.opacity <= 0) {
                    particles.splice(index, 1);
                }
            });
        }

        function createParticle(x, y) {
            particles.push({
                x: x,
                y: y,
                size: Math.random() * 5 + 2,
                speed: Math.random() * 2 + 1,
                opacity: 1
            });
        }

        function updateBird() {
            bird.velocity += bird.gravity;
            bird.y += bird.velocity;

            if (bird.y + bird.size > canvas.height || bird.y - bird.size < 0) {
                gameRunning = false;
                showRestartButton();
            }

            createParticle(bird.x, bird.y);
        }

        function drawPipes() {
            ctx.fillStyle = "white";
            pipes.forEach(pipe => {
                ctx.fillRect(pipe.x, 0, pipeWidth, pipe.topHeight);
                ctx.fillRect(pipe.x, pipe.topHeight + pipeGap, pipeWidth, canvas.height - pipe.topHeight - pipeGap);
            });
        }

        function updatePipes() {
            if (pipes.length === 0 || canvas.width - pipes[pipes.length - 1].x >= pipeDistance) {
                const topHeight = Math.random() * (canvas.height - pipeGap - 50) + 25;
                pipes.push({ x: canvas.width, topHeight });
            }

            pipes = pipes.filter(pipe => pipe.x + pipeWidth > 0);

            pipes.forEach(pipe => {
                pipe.x -= pipeSpeed;

                if (
                    bird.x + bird.size > pipe.x &&
                    bird.x - bird.size < pipe.x + pipeWidth &&
                    (bird.y - bird.size < pipe.topHeight || bird.y + bird.size > pipe.topHeight + pipeGap)
                ) {
                    gameRunning = false;
                    showRestartButton();
                }

                if (pipe.x + pipeWidth < bird.x && !pipe.passed) {
                    pipe.passed = true;
                    updateScore();
                }
            });
        }

        function jump() {
            if (gameRunning) {
                bird.velocity = bird.lift;
            }
        }

        document.addEventListener("keydown", (event) => {
            if (event.code === "Space") {
                if (!gameRunning) restartGame();
                jump();
            }
        });

        document.getElementById("jumpBtn").addEventListener("click", () => {
            if (!gameRunning) restartGame();
            jump();
        });

        document.getElementById("restartBtn").addEventListener("click", restartGame);

        function restartGame() {
            bird.y = canvas.height / 2;
            bird.velocity = 0;
            pipes = [];
            particles = [];
            score = 0;
            frame = 0;
            pipeSpeed = 2;
            hasSpeedIncreased = false;
            gameRunning = true;
            scoreDisplay.textContent = `Score: 0`;
            rankDisplay.innerHTML = `Rank: <span>Bot</span>`;
            highestRankDisplay.innerHTML = `Highest Rank: <span>${highestRank}</span>`;
            hideRestartButton();
            gameLoop();
        }

        function showRestartButton() {
            document.getElementById("restartBtn").style.display = "block";
        }

        function hideRestartButton() {
            document.getElementById("restartBtn").style.display = "none";
        }

        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (!gameRunning) return;

            drawParticles();
            drawBird();
            drawPipes();
            updatePipes();
            updateBird();

            frame++;
            requestAnimationFrame(gameLoop);
        }

        gameLoop();
    </script>
</body>

</html>
